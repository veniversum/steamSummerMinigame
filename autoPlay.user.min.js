!function(e){"use strict";function t(){return e.g_Minigame.m_CurrentScene}function n(){ue("Starting /u/wchill's script (version "+Le+")",1),Ke=t().DoCritEffect,Xe=t().m_rgClickNumbers.push,Ye=e.g_Minigame.Render,L(),Ne&&i(),Pe&&e.CEnemy&&(e.CEnemy.prototype.TakeDamage=function(){},e.CEnemySpawner.prototype.TakeDamage=function(){},e.CEnemyBoss.prototype.TakeDamage=function(){}),Oe&&E(),Ie&&f();var n=document.getElementById("abilities");n&&(n.style.textAlign="left"),xe&&(n=document.getElementById("global_header"),n&&n.parentNode&&n.parentNode.removeChild(n),n=document.getElementById("footer"),n&&n.parentNode&&n.parentNode.removeChild(n),n=document.getElementById("footer_spacer"),n&&n.parentNode&&n.parentNode.removeChild(n),n=document.querySelector(".pagecontent"),n&&(n.style["padding-bottom"]=0),document.body.style.backgroundPosition="0 0"),we&&u(Fe),Ge&&Te(),Be&&y(),void 0!==e.CSceneGame&&(e.CSceneGame.prototype.DoScreenShake=function(){}),r();var a=document.createElement("span");a.className="toggle_music_btn",a.textContent="Easter Egg",a.onclick=function(){e.SmackTV()},document.querySelector(".game_options").insertBefore(a,document.querySelector(".leave_game_btn"));var o=document.querySelector(".title_activity"),l=document.createElement("span");l.innerHTML='<span id="players_in_game">0/1500</span>&nbsp;Players in room<br>',o.insertBefore(l,o.firstChild);var m=document.getElementById("activitylog");m.style.marginTop="33px";var p=document.createElement("div");document.getElementsByClassName("pagecontent")[0].insertBefore(p,document.getElementsByClassName("footer_spacer")[0]),p.className="options_box";var g=document.querySelector(".options_box");g||(g=document.querySelector(".options_box")),g.innerHTML="<b>OPTIONS</b> (v"+Le+')<br>Settings marked with a <span style="color:#FF5252;font-size:22px;line-height:4px;vertical-align:bottom;">*</span> requires a refresh to take effect.<hr>',g.className="options_box",g.style.backgroundColor="#000000",g.style.width="600px",g.style.marginTop="12px",g.style.padding="12px",g.style.boxShadow="2px 2px 0 rgba( 0, 0, 0, 0.6 )",g.style.color="#ededed",g.style.marginLeft="auto",g.style.marginRight="auto";var v=g.cloneNode(!0),C=document.createElement("div");C.style["-moz-column-count"]=3,C.style["-webkit-column-count"]=3,C.style["column-count"]=3,C.style.width="100%",C.appendChild(d("enableAutoClicker","Enable autoclicker",Me,_,!1)),C.appendChild(d("removeInterface","Remove interface",xe,s,!0)),C.appendChild(d("removeParticles","Remove particle effects",Ne,s,!0)),C.appendChild(d("removeFlinching","Remove flinching effects",Pe,s,!0)),C.appendChild(d("removeCritText","Remove crit text",Oe,E,!1)),C.appendChild(d("removeGoldText","Remove gold text",ke,s,!1)),C.appendChild(d("removeAllText","Remove all text",Ie,f,!1)),C.appendChild(d("disableRenderer","Throttle game renderer",Be,y,!0)),"undefined"!=typeof GM_info&&C.appendChild(d("enableAutoRefresh","Enable auto-refresh",we,h,!1)),C.appendChild(d("enableFingering","Enable targeting pointer",Ge,s,!0)),C.appendChild(c("setLogLevel","Change the log level","25px",Ae,0,5,T)),g.appendChild(C),v.innerHTML="<b>GAME INFO</b><br/>",v.className="info_box",v.style.right="0px",Ze=document.createElement("div"),Ze.style["-moz-column-count"]=3,Ze.style["-webkit-column-count"]=3,Ze.style["column-count"]=3,Ze.appendChild(document.createElement("div")),Ze.appendChild(document.createElement("div")),Ze.appendChild(document.createElement("div")),v.appendChild(Ze),g.parentElement.appendChild(v);var b=document.querySelector(".leave_game_helper");b.parentElement.removeChild(b),be(),Re()}function a(){for(var e={1:":shelterwildfire:",2:":waterrune:",3:":Wisp:",4:":FateTree:"},n=0;3>n;n++){var a=t().m_rgGameData.lanes[n].element,r=t().m_rgLaneData[n].abilities;r||(r={});for(var i=[],o=0;4>o;o++){var l=t().GetEnemy(n,o);l&&i.push(l)}var m=t().m_rgLaneData[n].players,c="Lane "+(n+1)+' - <img src="http://cdn.steamcommunity.com/economy/emoticon/'+e[a]+'"><br>'+m+" players";Ze.children[n].innerHTML=c}}function r(){e.$J(".tv_ui").css("background-image","url(http://i.imgur.com/ieDoLnx.png)"),e.$J("#activeinlanecontainer").css("height","154px"),e.$J("#activitycontainer").css("height","270px"),e.$J("#activityscroll").css("height","270px")}function i(){e.CSceneGame&&(e.CSceneGame.prototype.DoScreenShake=function(){},Ne&&(e.CSceneGame.prototype.SpawnEmitter=function(e){return e.emit=!1,e}))}function o(){var e=new Date,t=e.getUTCHours(),n=e.getUTCMinutes(),a=60-n;return 15==t&&a<=ze.minsLeft?!0:!1}function l(){if(!He){He=!0;var n=Se();if(10>n&&ze.useSlowMode)return;a(),K(),H(),M(),x(),P(),N(),I(),U(),O(),k(),w(),G(),B(),(n<ze.speedThreshold||n%ze.rainingRounds===0)&&n>ze.useGoldThreshold&&F(),G(n),$(n),W(),q(),A(),n!==$e&&($e=n,_e(n),m()),Je=v(),t().m_nClicks=Je,t().m_nLastTick=!1,e.g_msTickRate=1e3;var r=t().CalculateDamage(t().m_rgPlayerTechTree.damage_per_click,t().m_rgGameData.lanes[t().m_rgPlayerData.current_lane].element);ue("Ticked. Current clicks per second: "+Je+". Current damage per second: "+r*Je,4),Be&&(t().Tick(),requestAnimationFrame(function(){e.g_Minigame.Renderer.render(t().m_Container)})),He=!1;var i=t().GetEnemy(t().m_rgPlayerData.current_lane,t().m_rgPlayerData.target);if(Je>0&&i){if(D(i.m_Sprite.position.x-440*i.m_nLane,i.m_Sprite.position.y-52,"-"+e.FormatNumberForDisplay(r*Je,5),"#aaf"),t().m_rgStoredCrits.length>0){var o=t().m_rgStoredCrits.reduce(function(e,t){return e+t});t().m_rgStoredCrits.length=0,t().DoCritEffect(o,i.m_Sprite.position.x-440*i.m_nLane,i.m_Sprite.position.y+17,"Crit!")}var l=t().m_rgGameData.lanes[t().m_rgPlayerData.current_lane].active_player_ability_gold_per_click;if(l>0&&i.m_data.hp>0){var c=i.m_data.gold*l*Je;t().ClientOverride("player_data","gold",t().m_rgPlayerData.gold+c),t().ApplyClientOverrides("player_data",!0),ue("Raining gold ability is active in current lane. Percentage per click: "+l+"%. Approximately gold per second: "+c,4),ke||D(i.m_Sprite.position.x-440*i.m_nLane,i.m_Sprite.position.y-17,"+"+e.FormatNumberForDisplay(c,5),"#e1b21e")}}for(var d=4;d>=0;d--)Qe[d+1]=Qe[d];0!==je&&(Qe[0]=Se()-je),je=Se()}}function m(){ue("Refreshing player data",2),e.g_Server.GetPlayerData(function(n){var a=t();n.response.player_data&&(a.m_rgPlayerData=n.response.player_data,a.ApplyClientOverrides("player_data"),a.ApplyClientOverrides("ability")),n.response.tech_tree&&(a.m_rgPlayerTechTree=n.response.tech_tree,n.response.tech_tree.upgrades?a.m_rgPlayerUpgrades=e.V_ToArray(n.response.tech_tree.upgrades):a.m_rgPlayerUpgrades=[]),a.OnReceiveUpdate()},function(){},!0)}function c(t,n,a,r,i,o,l){var m=document.createElement("label"),c=document.createTextNode(n),d=document.createElement("input");return d.type="number",d.name=t,d.style.width=a,d.style.marginRight="5px",d.value=r,d.min=i,d.max=o,d.onchange=l,e[d.name]=d,m.appendChild(d),m.appendChild(c),m.appendChild(document.createElement("br")),m}function d(t,n,a,r,i){var o=document.createElement("span");o.appendChild(document.createTextNode("*")),o.style.color="#FF5252",o.style.fontSize="22px",o.style.lineHeight="14px",o.style.verticalAlign="bottom";var l=document.createElement("label"),m=document.createTextNode(n),c=document.createElement("input");return c.type="checkbox",c.name=t,c.checked=a,c.onclick=r,e[c.name]=c.checked,l.appendChild(c),l.appendChild(m),i&&l.appendChild(o),l.appendChild(document.createElement("br")),l}function s(e){g(e)}function u(e){var t=60*(e+Ue*Math.random())*1e3;qe=setTimeout(function(){p()},t)}function p(){var n=t().GetEnemy(t().m_rgPlayerData.current_lane,t().m_rgPlayerData.target).m_data;if("undefined"!=typeof n){var a=n.type;a!=nt.BOSS?(ue("Refreshing, not boss",5),e.location.reload(!0)):(ue("Not refreshing, A boss!",5),setTimeout(p,3e3))}else setTimeout(p,1e3)}function g(t){var n=t.target;return b(n.name,n.checked),e[n.name]=n.checked,n.checked}function _(e){var t=Me;void 0!==e&&(t=g(e)),Me=t,ue("Autoclicker is "+Me,1)}function h(e){var t=we;void 0!==e&&(t=g(e)),t?u(Fe):clearTimeout(qe)}function y(t){var n=Be;void 0!==t&&(n=Be=g(t));var a=e.PIXI.ticker.shared;n?(a.autoStart=!1,a.stop(),e.g_Minigame.Render=function(){}):(a.autoStart=!0,a.start(),e.g_Minigame.Render=Ye,e.g_Minigame.Render())}function E(e){var n=Oe;void 0!==e&&(n=g(e)),n?t().DoCritEffect=function(e,t,n,a){}:t().DoCritEffect=Ke}function f(e){var n=Ie;void 0!==e&&(n=g(e)),n?t().m_rgClickNumbers.push=function(e){e.container.removeChild(e)}:t().m_rgClickNumbers.push=Xe}function v(){var e=Se();return Me?e%ze.rainingRounds===0?ie(et.WORMHOLE)?0:Math.floor(De/2):De:0}function C(){for(var e=0,t=3;t>=0;t--)Qe[t+1]=Qe[t],e+=Qe[t];return e+=Qe[0]}function T(e){void 0!==e&&(Ae=e.target.value)}function b(e,t){try{"undefined"!==localStorage&&localStorage.setItem("steamdb-minigame/"+e,t)}catch(n){console.log(n)}}function S(e,t){try{if("undefined"!==localStorage){var n=localStorage.getItem("steamdb-minigame/"+e);return null!==n?n:t}}catch(a){return console.log(a),t}}function R(e,t){return"true"==S(e,t.toString())}function L(){for(var e=document.querySelector('a.link.element_upgrade_btn[data-type="3"]'),t=document.querySelector('a.link.element_upgrade_btn[data-type="4"]'),n=document.querySelector('a.link.element_upgrade_btn[data-type="5"]'),a=document.querySelector('a.link.element_upgrade_btn[data-type="6"]'),r=[e,t,n,a],i=0;i<r.length;i++)r[i].style.visibility="hidden"}function D(n,a,r,i){var o=new e.PIXI.Text(r,{font:"35px 'Press Start 2P'",fill:i,stroke:"#000",strokeThickness:2});o.x=n,o.y=a,t().m_containerUI.addChild(o),o.container=t().m_containerUI;var l=new e.CEasingSinOut(o.y,-200,1e3);l.parent=o,o.m_easeY=l,l=new e.CEasingSinOut(2,-2,1e3),l.parent=o,o.m_easeAlpha=l,t().m_rgClickNumbers.push(o)}function A(){var e=t().m_rgLaneData[0].players+t().m_rgLaneData[1].players+t().m_rgLaneData[2].players;document.getElementById("players_in_game").innerHTML=e+"/1500"}function M(){for(var e,n=.4,a=.1,r=!1,i=0,l=0,m=0,c=0,d=-1,s=-1,u=[nt.TREASURE,nt.BOSS,nt.MINIBOSS,nt.SPAWNER,nt.CREEP],p=!1,g=0,_=0,h=!1,y=!1,E=0;!r&&E<u.length;E++){h=u[E]==nt.TREASURE,y=u[E]==nt.BOSS;var f=[];for(e=0;3>e;e++)for(var v=0;4>v;v++){var C=t().GetEnemy(e,v);C&&C.m_data.type==u[E]&&(f[f.length]=C)}if(!h&&!y)for(var T=0,b=me(),S=0;S<b.length;S++)if(e=b[S],0!==t().m_rgGameData.lanes[e].dps){var R=0;"undefined"!=typeof t().m_rgLaneData[e].abilities[17]&&(R=t().m_rgLaneData[e].abilities[17],ue("stacks: "+R,3));for(var L=0;L<t().m_rgEnemies.length;L++){var D=t().m_rgEnemies[L].m_data.gold;R*D>T&&(T=R*D,s=t().m_rgEnemies[L].m_nID,d=e)}}var A=0;for(e=0;e<f.length;e++)if(f[e]&&!f[e].m_bIsDestroyed){if(1>i||f[e].m_flDisplayedHP<i){var M=t().m_rgGameData.lanes[f[e].m_nLane].element,x=t().CalculateDamage(t().m_rgPlayerTechTree.dps,M);if(!(x>=A))continue;A=x,r=!0,i=f[e].m_flDisplayedHP,l=f[e].m_nLane,m=f[e].m_nID}var N=f[e].m_flDisplayedHP/f[e].m_data.max_hp;(0===c||c>N)&&(c=N)}-1!=d&&-1!=s&&(l=d,m=s,ue("Switching to a lane with best raining gold benefit",2)),u[E]==nt.SPAWNER&&c>n&&-1==d&&(g=l,_=m,p=!0,r=!1),p&&u[E]==nt.CREEP&&c>a&&(l=g,m=_)}if(r){t().m_nExpectedLane!=l&&(ue("Switching to lane"+l,3),t().TryChangeLane(l)),t().m_nTarget!=m&&(ue("Switching targets",3),t().TryChangeTarget(m));var P=Se();h||y&&(P<ze.speedThreshold||P%ze.rainingRounds===0)?tt.forEach(X):tt.forEach(Y),P<ze.allowWormholeLevel&&!o()||Y(et.WORMHOLE)}}function x(){return de(et.DECREASE_COOLDOWNS)>0||Math.random()>ze.useAbilityChance?void X(et.DECREASE_COOLDOWNS):(V(et.DECREASE_COOLDOWNS)||Y(et.DECREASE_COOLDOWNS),void ee(et.DECREASE_COOLDOWNS))}function N(e){return oe(et.PUMPED_UP)?void ue("Pumped up is always good.",2):(ee(et.MEDICS)&&ue("Medics is purchased, cooled down. Trigger it.",2),void(e>ze.reflectDamageThreshold&&oe(et.REFLECT_DAMAGE)?ue("We have reflect damage, cooled down. Trigger it.",2):e>ze.stealHealthThreshold&&oe(et.STEAL_HEALTH)?ue("We have steal health, cooled down. Trigger it.",2):oe(et.GOD_MODE)&&ue("We have god mode, cooled down. Trigger it.",2)))}function P(){oe(et.CRIT)&&ue("Crit chance is always good.",3),ee(et.GOOD_LUCK_CHARMS)&&ue("Good Luck Charms is purchased, cooled down, and needed. Trigger it.",2)}function O(){if(j(et.CLUSTER_BOMB)&&Z()&&!(Math.random()>ze.useAbilityChance)){for(var e=t().m_nExpectedLane,n=0,a=!1,r=Se(),i=0;4>i;i++){var o=t().GetEnemy(e,i);o&&(n++,(0===o.m_data.type||r>ze.speedThreshold&&r%ze.rainingRounds!==0&&r%10===0)&&(a=!0))}a&&n>=3&&te(et.CLUSTER_BOMB)}}function k(){if(j(et.NAPALM)&&Z()&&!(Math.random()>ze.useAbilityChance)){var e=t().m_nExpectedLane,n=0,a=!1,r=Se();if(!(r%ze.rainingRounds>ze.rainingRounds-ze.rainingSafeRounds)){for(var i=0;4>i;i++){var o=t().GetEnemy(e,i);o&&(n++,(0===o.m_data.type||r>ze.speedThreshold&&r%ze.rainingRounds!==0&&r%10===0)&&(a=!0))}a&&n>=3&&te(et.NAPALM)}}}function I(){if(j(et.MORALE_BOOSTER)&&!(Math.random()>ze.useAbilityChance)){for(var e=0,n=0;n<t().m_rgGameData.lanes[t().m_nExpectedLane].enemies.length;n++)t().m_rgGameData.lanes[t().m_nExpectedLane].enemies[n].hp>1e6&&e++;e>=2&&(ue("Moral Booster is purchased, cooled down, and needed. Trigger it.",2),te(et.MORALE_BOOSTER))}}function w(){if(j(et.TACTICAL_NUKE)&&Z()&&!(Math.random()>ze.useAbilityChance)){for(var e=t().m_nExpectedLane,n=!1,a=0,r=Se(),i=0;4>i;i++){var o=t().GetEnemy(e,i);o&&(0===o.m_data.type||r>ze.speedThreshold&&r%ze.rainingRounds!==0&&r%10===0)&&(n=!0,a=o.m_flDisplayedHP/o.m_data.max_hp)}n&&.6>a&&a>.3&&(ue("Tactical Nuke is purchased, cooled down, and needed. Nuke 'em.",2),te(et.TACTICAL_NUKE))}}function G(){}function B(){if(re(et.CRIPPLE_SPAWNER)&&!(Math.random()>ze.useAbilityChance)){for(var e=t().m_nExpectedLane,n=!1,a=0,r=0;4>r;r++){var i=t().GetEnemy(e,r);i&&0===i.m_data.type&&(n=!0,a=i.m_flDisplayedHP/i.m_data.max_hp)}n&&a>.95&&(ue("Cripple Spawner available, and needed. Cripple 'em.",2),le(et.CRIPPLE_SPAWNER))}}function F(){if(re(et.RAINING_GOLD)){var e=t().GetEnemy(t().m_rgPlayerData.current_lane,t().m_rgPlayerData.target);if(e&&e.m_data.type==nt.BOSS){var n=e.m_flDisplayedHP/e.m_data.max_hp;n>=.6&&(ue("Gold rain is purchased and cooled down, Triggering it on boss",2),le(et.RAINING_GOLD))}}}function U(){if((Se()<=30||Se()>=1e5)&&re(et.TREASURE)&&le(et.TREASURE),j(et.METAL_DETECTOR)||re(et.TREASURE)){if(V(et.METAL_DETECTOR))return;var e=t().GetEnemy(t().m_rgPlayerData.current_lane,t().m_rgPlayerData.target);if(e&&e.m_data.type==nt.BOSS){var n=e.m_flDisplayedHP/e.m_data.max_hp;.25>=n&&(j(et.METAL_DETECTOR)?(ue("Metal Detector is purchased and cooled down, Triggering it on boss",2),te(et.METAL_DETECTOR)):re(et.TREASURE)&&(ue("Treasure is available and cooled down, Triggering it on boss",2),le(et.TREASURE)))}}}function W(){V(et.MAX_ELEMENTAL_DAMAGE)||Math.random()>ze.useAbilityChance||oe(et.MAX_ELEMENTAL_DAMAGE,!0)&&ue("Max Elemental Damage is purchased and cooled down, triggering it.",2)}function H(){var e=Se();e<ze.speedThreshold||e%ze.rainingRounds!==0||(oe(et.WORMHOLE)?ue("Less than "+ze.minsLeft+" minutes for game to end. Triggering wormholes...",2):o()&&oe(et.THROW_MONEY_AT_SCREEN)&&ue("Less than "+ze.minsLeft+" minutes for game to end. Throwing money at screen for no particular reason...",2))}function q(){var e=Se();if(e%ze.rainingRounds!==0&&!Ve)return void(Ve=!0);var n=(ce()-t().m_rgGameData.timestamp_game_start)/3600,a=(ze.useLikeNewMaxChance-ze.useLikeNewMinChance)*n/24+ze.useLikeNewMinChance;if(!(re(et.WORMHOLE)||Math.random()>a||e%ze.rainingRounds!==0)&&Ve){var r=Math.floor(Math.random()*ze.useLikeNewTimeSpread*2+(ze.speedThreshold-ze.useLikeNewTimeSpread));setTimeout(J,r),ue("Attempting to use Like New after "+r+"ms.",2),Ve=!1}}function J(){var e=Se();e%ze.rainingRounds===0&&oe(et.LIKE_NEW)&&(ue("We can actually use Like New semi-reliably! Cooldowns-b-gone.",2),Ve=!0)}function $(e){e%10===9&&Math.random()<=ze.useAbilityChance&&oe(et.RESURRECTION)&&ue("Triggered Resurrect.")}function K(){t().m_bIsDead&&t().m_rgPlayerData.time_died+5<t().m_nTime&&e.RespawnPlayer()}function X(e){z(e,!1)}function Y(e){z(e,!0)}function z(e,t){var n=t===!0?"visible":"hidden",a=document.getElementById("ability_"+e);a||(a=document.getElementById("abilityitem_"+e)),a&&a.childElements()&&a.childElements().length>=1&&(a.childElements()[0].style.visibility=n)}function V(e){return t().bIsAbilityActive(e)}function Q(e){var t=document.getElementById("ability_"+e);return t&&t.childElements()&&t.childElements().length>=1?"hidden"!==t.childElements()[0].style.visibility:!1}function j(e){return ae(e)&&!ne(e)&&Q(e)}function Z(){var e=Se(),t=e%ze.rainingRounds;return t>0&&t<ze.rainingRounds-ze.rainingSafeRounds}function ee(e){return j(e)?(te(e),!0):!1}function te(e){t().m_rgAbilityQueue.push({ability:e})}function ne(e){return t().GetCooldownForAbility(e)>0}function ae(e){return 1<<e&t().m_rgPlayerTechTree.unlocked_abilities_bitfield}function re(e){return ie(e)&&!ne(e)&&se(e)}function ie(e){for(var n=0;n<t().m_rgPlayerTechTree.ability_items.length;++n){var a=t().m_rgPlayerTechTree.ability_items[n];if(a.ability==e)return!0}return!1}function oe(e,t){return re(e)?t&&de(e)>0?!1:(le(e),!0):!1}function le(e){var n=document.getElementById("abilityitem_"+e);n&&n.childElements()&&n.childElements().length>=1&&t().TryAbility(document.getElementById("abilityitem_"+e).childElements()[0])}function me(){for(var e=[t().m_rgPlayerTechTree.damage_multiplier_fire,t().m_rgPlayerTechTree.damage_multiplier_water,t().m_rgPlayerTechTree.damage_multiplier_air,t().m_rgPlayerTechTree.damage_multiplier_earth],n=t().m_rgGameData.lanes,a=[],r=0;r<n.length;r++)a[r]=r;return a.sort(function(t,a){return e[n[a].element-1]-e[n[t].element-1]}),ue("Lane IDs  : "+a[0]+" "+a[1]+" "+a[2],4),ue("Elements  : "+n[a[0]].element+" "+n[a[1]].element+" "+n[a[2]].element,4),a}function ce(){return t().m_rgGameData.timestamp}function de(e){for(var n=(ce(),t().m_rgGameData.lanes[t().m_rgPlayerData.current_lane].active_player_abilities),a=0,r=0;r<n.length;r++)n[r].ability!=e||n[r].timestamp_done<Date.now()||a++;return a}function se(e){var t=document.getElementById("abilityitem_"+e);return t&&t.childElements()&&t.childElements().length>=1?"hidden"!==t.childElements()[0].style.visibility:!1}function ue(e,t){Ae>=t&&console.log(e)}function pe(e){for(var t=0,n=0,a=0;24>a;a++)e>=3600&&(e-=3600,t+=1);for(var r=0;60>r;r++)e>=60&&(e-=60,n+=1);return{hours:t,minutes:n}}function ge(e){var n=Math.floor(t().m_nTime)%86400;n-=57600,0>n&&(n+=86400);var a=86400-n,r=ce()-t().m_rgGameData.timestamp_game_start,i=Math.floor(e/r*a+e),o=Math.floor((i-e)/Math.log(3))+e;return{expected_level:i,likely_level:o,remaining_time:a}}function _e(e){var t=ge(e),n=pe(t.remaining_time),a=C();document.ExpectedLevel.textContent="Level: "+e+", Expected Level: "+t.expected_level+", Likely Level: "+t.likely_level,document.RemainingTime.textContent="Remaining Time: "+n.hours+" hours, "+n.minutes+" minutes.",document.LevelsSkip.textContent="Skipped "+a+" levels in last 5s."}function he(){return 100*t().m_rgPlayerTechTree.crit_percentage}function ye(){return t().m_rgPlayerTechTree.damage_multiplier_crit}function Ee(){return t().m_rgPlayerTechTree.dps}function fe(){return t().m_rgPlayerTechTree.damage_per_click}function ve(){return t().m_rgPlayerTechTree.damage_per_click_multiplier}function Ce(){return 100*t().m_rgPlayerTechTree.boss_loot_drop_percentage}function Te(){e.CSceneGame.prototype.ClearNewPlayer=function(){},t().m_spriteFinger||(e.WebStorage.SetLocal("mg_how2click",0),t().CheckNewPlayer(),e.WebStorage.SetLocal("mg_how2click",1)),document.getElementById("newplayer").style.display="none"}function be(){var t=e.fnTooltipUpgradeDesc;e.fnTooltipUpgradeDesc=function(n){var a=e.$J(n),r=a.data("desc"),i=r,o=parseFloat(a.data("multiplier"));switch(a.data("upgrade_type")){case 2:i=t(n);var l=fe()*ye(),m=e.g_Minigame.CurrentScene().m_rgTuningData.player.damage_per_click*(ve()+o)*ye();i+="<br><br>Crit Click: "+e.FormatNumberForDisplay(l)+" => "+e.FormatNumberForDisplay(m);break;case 7:var c=ye(),d=c+o,s=Ee(),u=fe();i+="<br><br>You can have multiple crits in a second. The server combines them into one.",i+="<br><br>Crit Percentage: "+he().toFixed(1)+"%",i+="<br><br>Critical Damage Multiplier:",i+="<br>Current: "+c+"x",i+="<br>Next Level: "+d+"x",i+="<br><br>Damage with one crit:",i+="<br>DPS: "+e.FormatNumberForDisplay(c*s)+" => "+e.FormatNumberForDisplay(d*s),i+="<br>Click: "+e.FormatNumberForDisplay(c*u)+" => "+e.FormatNumberForDisplay(d*u),i+="<br><br>Base Increased By: "+e.FormatNumberForDisplay(o)+"x";break;case 9:i+="<br><br>Boss Loot Drop Rate:",i+="<br>Current: "+Ce().toFixed(0)+"%",i+="<br>Next Level: "+(Ce()+100*o).toFixed(0)+"%",i+="<br><br>Base Increased By: "+e.FormatNumberForDisplay(100*o)+"%";break;default:return t(n)}return i}}function Se(){return t().m_rgGameData.level+1}function Re(){var t=e.$J('<button onclick="setBadgeItemByMultiplier(1)" type="button">x1</button>'),n=e.$J('<button onclick="setBadgeItemByMultiplier(10)" type="button">x10</button>'),a=e.$J('<button onclick="setBadgeItemByMultiplier(100)" type="button">x100</button>');e.$J("#badge_items").append("<span>Batch purchase : </span>").append(t).append(n).append(a);var r=1;e.setBadgeItemByMultiplier=function(e){"number"==typeof e&&e>=1&&(r=Math.floor(e))},e.$J("#badge_items > .purchase_ability_item").each(function(){var t=e.$J(this);t.attr("onclick",""),t.click(function(t){e.g_Minigame.CurrentScene().TrySpendBadgePoints(this);var n=e.g_Minigame.CurrentScene().m_rgPurchaseItemsQueue;if(r>1&&n.length>0)for(var a=n[n.length-1],i=1;r>i;i++)n.push(a);return!1})})}var Le="4.6.3",De=20,Ae=1,Me=R("enableAutoClicker",!0),xe=R("removeInterface",!0),Ne=R("removeParticles",!0),Pe=R("removeFlinching",!0),Oe=R("removeCritText",!1),ke=R("removeGoldText",!1),Ie=R("removeAllText",!1),we=R("enableAutoRefresh","undefined"!=typeof GM_info),Ge=R("enableFingering",!0),Be=R("disableRenderer",!1),Fe=30,Ue=10,We=30,He=!1,qe=null,Je=Me?De:0,$e=0,Ke=function(){},Xe=function(){},Ye=function(){},ze={speedThreshold:2e3,rainingSafeRounds:5,rainingRounds:100,timePerUpdate:6e4,useSlowMode:!1,minsLeft:60,allowWormholeLevel:18e4,githubVersion:Le,useAbilityChance:.03,useLikeNewMinChance:.01,useLikeNewMaxChance:.5,useLikeNewTimeSpread:1e3,useGoldThreshold:200},Ve=!0,Qe=[0,0,0,0,0],je=0,Ze=(R("showedUpdateInfo",!1),{}),et={FIRE_WEAPON:1,CHANGE_LANE:2,RESPAWN:3,CHANGE_TARGET:4,MORALE_BOOSTER:5,GOOD_LUCK_CHARMS:6,MEDICS:7,METAL_DETECTOR:8,DECREASE_COOLDOWNS:9,TACTICAL_NUKE:10,CLUSTER_BOMB:11,NAPALM:12,RESURRECTION:13,CRIPPLE_SPAWNER:14,CRIPPLE_MONSTER:15,MAX_ELEMENTAL_DAMAGE:16,RAINING_GOLD:17,CRIT:18,PUMPED_UP:19,THROW_MONEY_AT_SCREEN:20,GOD_MODE:21,TREASURE:22,STEAL_HEALTH:23,REFLECT_DAMAGE:24,FEELING_LUCKY:25,WORMHOLE:26,LIKE_NEW:27},tt=[et.MORALE_BOOSTER,et.GOOD_LUCK_CHARMS,et.TACTICAL_NUKE,et.CLUSTER_BOMB,et.NAPALM,et.CRIT,et.CRIPPLE_SPAWNER,et.CRIPPLE_MONSTER,et.MAX_ELEMENTAL_DAMAGE,et.REFLECT_DAMAGE,et.THROW_MONEY_AT_SCREEN],nt={SPAWNER:0,CREEP:1,BOSS:2,MINIBOSS:3,TREASURE:4};i(),e.SteamDB_Minigame_Timer&&e.clearInterval(e.SteamDB_Minigame_Timer),e.SteamDB_Minigame_Timer=e.setInterval(function(){e.g_Minigame&&t().m_bRunning&&t().m_rgPlayerTechTree&&t().m_rgGameData&&(e.clearInterval(e.SteamDB_Minigame_Timer),n(),e.SteamDB_Minigame_Timer=e.setInterval(l,1e3))},1e3),e.setTimeout(function(){e.g_Minigame&&e.g_Minigame.m_CurrentScene&&e.g_Minigame.m_CurrentScene.m_rgGameData||e.location.reload(!0)},1e3*We);var at=document.querySelector(".breadcrumbs");if(at){var rt=document.createElement("span");rt.textContent=" > ",at.appendChild(rt),rt=document.createElement("span"),rt.style.color="#D4E157",rt.style.textShadow="1px 1px 0px rgba( 0, 0, 0, 0.3 )",rt.textContent="Room "+e.g_GameID,at.appendChild(rt),rt=document.createElement("span"),rt.textContent=" > ",at.appendChild(rt),rt=document.createElement("span"),rt.style.color="#FFA07A",rt.style.textShadow="1px 1px 0px rgba( 0, 0, 0, 0.3 )",rt.textContent="Level: 0, Expected Level: 0, Likely Level: 0",at.appendChild(rt),document.ExpectedLevel=rt,rt=document.createElement("span"),rt.textContent=" > ",at.appendChild(rt),rt=document.createElement("span"),rt.style.color="#9AC0FF",rt.style.textShadow="1px 1px 0px rgba( 0, 0, 0, 0.3 )",rt.textContent="Remaining Time: 0 hours, 0 minutes.",at.appendChild(rt),document.RemainingTime=rt,rt=document.createElement("span"),rt.textContent=" > ",at.appendChild(rt),rt=document.createElement("span"),rt.style.color="#33FF33",rt.style.textShadow="1px 1px 0px rgba( 0, 0, 0, 0.3 )",rt.textContent="Skipped 0 levels in last 5s.",at.appendChild(rt),document.LevelsSkip=rt}}(window);