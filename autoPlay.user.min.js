!function(e){"use strict";function t(){return e.g_Minigame.m_CurrentScene}function n(){de("Starting /u/wchill's script (version "+be+")",1),Je=t().DoCritEffect,Xe=t().m_rgClickNumbers.push,Ye=e.g_Minigame.Render,Ge&&R(),Ae&&i(),xe&&e.CEnemy&&(e.CEnemy.prototype.TakeDamage=function(){},e.CEnemySpawner.prototype.TakeDamage=function(){},e.CEnemyBoss.prototype.TakeDamage=function(){}),Me&&f(),Oe&&v();var n=document.getElementById("abilities");n&&(n.style.textAlign="left"),Le&&(n=document.getElementById("global_header"),n&&n.parentNode&&n.parentNode.removeChild(n),n=document.getElementById("footer"),n&&n.parentNode&&n.parentNode.removeChild(n),n=document.getElementById("footer_spacer"),n&&n.parentNode&&n.parentNode.removeChild(n),n=document.querySelector(".pagecontent"),n&&(n.style["padding-bottom"]=0),document.body.style.backgroundPosition="0 0"),Ne&&u(we),ke&&ve(),Ie&&h(),void 0!==e.CSceneGame&&(e.CSceneGame.prototype.DoScreenShake=function(){}),r();var a=document.createElement("span");a.className="toggle_music_btn",a.textContent="Easter Egg",a.onclick=function(){e.SmackTV()},document.querySelector(".game_options").insertBefore(a,document.querySelector(".leave_game_btn"));var o=document.querySelector(".title_activity"),l=document.createElement("span");l.innerHTML='<span id="players_in_game">0/1500</span>&nbsp;Players in room<br>',o.insertBefore(l,o.firstChild);var m=document.getElementById("activitylog");m.style.marginTop="33px";var p=document.createElement("div");document.getElementsByClassName("pagecontent")[0].insertBefore(p,document.getElementsByClassName("footer_spacer")[0]),p.className="options_box";var g=document.querySelector(".options_box");g||(g=document.querySelector(".options_box")),g.innerHTML="<b>OPTIONS</b> (v"+be+')<br>Settings marked with a <span style="color:#FF5252;font-size:22px;line-height:4px;vertical-align:bottom;">*</span> requires a refresh to take effect.<hr>',g.className="options_box",g.style.backgroundColor="#000000",g.style.width="600px",g.style.marginTop="12px",g.style.padding="12px",g.style.boxShadow="2px 2px 0 rgba( 0, 0, 0, 0.6 )",g.style.color="#ededed",g.style.marginLeft="auto",g.style.marginRight="auto";var C=g.cloneNode(!0),b=document.createElement("div");b.style["-moz-column-count"]=3,b.style["-webkit-column-count"]=3,b.style["column-count"]=3,b.style.width="100%",b.appendChild(d("enableAutoClicker","Enable autoclicker",Re,_,!1)),b.appendChild(d("removeInterface","Remove interface",Le,s,!0)),b.appendChild(d("removeParticles","Remove particle effects",Ae,s,!0)),b.appendChild(d("removeFlinching","Remove flinching effects",xe,s,!0)),b.appendChild(d("removeCritText","Remove crit text",Me,f,!1)),b.appendChild(d("removeGoldText","Remove gold text",Pe,s,!1)),b.appendChild(d("removeAllText","Remove all text",Oe,v,!1)),b.appendChild(d("disableRenderer","Throttle game renderer",Ie,h,!0)),"undefined"!=typeof GM_info&&b.appendChild(d("enableAutoRefresh","Enable auto-refresh",Ne,y,!1)),b.appendChild(d("enableFingering","Enable targeting pointer",ke,s,!0)),b.appendChild(c("setLogLevel","Change the log level","25px",De,0,5,T)),g.appendChild(b),C.innerHTML="<b>GAME INFO</b><br/>",C.className="info_box",C.style.right="0px",ze=document.createElement("div"),ze.style["-moz-column-count"]=3,ze.style["-webkit-column-count"]=3,ze.style["column-count"]=3,ze.appendChild(document.createElement("div")),ze.appendChild(document.createElement("div")),ze.appendChild(document.createElement("div")),C.appendChild(ze),g.parentElement.appendChild(C);var S=document.querySelector(".leave_game_helper");S.parentElement.removeChild(S);var D=document.getElementById("abilities"),L=document.createElement("div");L.className="lock_elements_box",L.style.width="165px",L.style.top="-76px",L.style.left="303px",L.style.boxSizing="border-box",L.style.lineHeight="1rem",L.style.padding="7px 10px",L.style.position="absolute",L.style.color="#ededed",L.title="To maximise team damage players should max only one element. But distributions of elements through people should be equal. So we calculated your element using your unique ID. Upgrade your element to make maximum performance or disable this checkbox.";var A=d("enableElementLock","Lock element upgrades for more team dps",Ge,E,!1);L.appendChild(A),D.appendChild(L),Te()}function a(){for(var e={1:":shelterwildfire:",2:":waterrune:",3:":Wisp:",4:":FateTree:"},n=0;3>n;n++){var a=t().m_rgGameData.lanes[n].element,r=t().m_rgLaneData[n].abilities;r||(r={});for(var i=[],o=0;4>o;o++){var l=t().GetEnemy(n,o);l&&i.push(l)}var m=t().m_rgLaneData[n].players,c="Lane "+(n+1)+' - <img src="http://cdn.steamcommunity.com/economy/emoticon/'+e[a]+'"><br>'+m+" players";ze.children[n].innerHTML=c}}function r(){e.$J(".tv_ui").css("background-image","url(http://i.imgur.com/ieDoLnx.png)"),e.$J("#activeinlanecontainer").css("height","154px"),e.$J("#activitycontainer").css("height","270px"),e.$J("#activityscroll").css("height","270px")}function i(){e.CSceneGame&&(e.CSceneGame.prototype.DoScreenShake=function(){},Ae&&(e.CSceneGame.prototype.SpawnEmitter=function(e){return e.emit=!1,e}))}function o(){var e=new Date,t=e.getUTCHours(),n=e.getUTCMinutes(),a=60-n;return 15==t&&a<=$e.minsLeft?!0:!1}function l(){if(!Ue){Ue=!0;var n=Ce();if(10>n&&$e.useSlowMode)return;a(),J(),M(),P(),N(),O(),G(),H(),k(),I(),w(),B(),F(),(n<$e.speedThreshold||n%$e.rainingRounds===0)&&n>$e.useGoldThreshold&&U(),B(n),K(n),W(),q(),x(),n!==Ke&&(Ke=n,pe(n),m()),t().m_nClicks=We,t().m_nLastTick=!1,e.g_msTickRate=1e3;var r=t().CalculateDamage(t().m_rgPlayerTechTree.damage_per_click,t().m_rgGameData.lanes[t().m_rgPlayerData.current_lane].element);de("Ticked. Current clicks per second: "+We+". Current damage per second: "+r*We,4),Ie&&(t().Tick(),requestAnimationFrame(function(){e.g_Minigame.Renderer.render(t().m_Container)})),Ue=!1;var i=t().GetEnemy(t().m_rgPlayerData.current_lane,t().m_rgPlayerData.target);if(We>0&&i){if(A(i.m_Sprite.position.x-440*i.m_nLane,i.m_Sprite.position.y-52,"-"+e.FormatNumberForDisplay(r*We,5),"#aaf"),t().m_rgStoredCrits.length>0){var o=t().m_rgStoredCrits.reduce(function(e,t){return e+t});t().m_rgStoredCrits.length=0,t().DoCritEffect(o,i.m_Sprite.position.x-440*i.m_nLane,i.m_Sprite.position.y+17,"Crit!")}var l=t().m_rgGameData.lanes[t().m_rgPlayerData.current_lane].active_player_ability_gold_per_click;if(l>0&&i.m_data.hp>0){var c=i.m_data.gold*l*We;t().ClientOverride("player_data","gold",t().m_rgPlayerData.gold+c),t().ApplyClientOverrides("player_data",!0),de("Raining gold ability is active in current lane. Percentage per click: "+l+"%. Approximately gold per second: "+c,4),Pe||A(i.m_Sprite.position.x-440*i.m_nLane,i.m_Sprite.position.y-17,"+"+e.FormatNumberForDisplay(c,5),"#e1b21e")}}}}function m(){de("Refreshing player data",2),e.g_Server.GetPlayerData(function(n){var a=t();n.response.player_data&&(a.m_rgPlayerData=n.response.player_data,a.ApplyClientOverrides("player_data"),a.ApplyClientOverrides("ability")),n.response.tech_tree&&(a.m_rgPlayerTechTree=n.response.tech_tree,n.response.tech_tree.upgrades?a.m_rgPlayerUpgrades=e.V_ToArray(n.response.tech_tree.upgrades):a.m_rgPlayerUpgrades=[]),a.OnReceiveUpdate()},function(){},!0)}function c(t,n,a,r,i,o,l){var m=document.createElement("label"),c=document.createTextNode(n),d=document.createElement("input");return d.type="number",d.name=t,d.style.width=a,d.style.marginRight="5px",d.value=r,d.min=i,d.max=o,d.onchange=l,e[d.name]=d,m.appendChild(d),m.appendChild(c),m.appendChild(document.createElement("br")),m}function d(t,n,a,r,i){var o=document.createElement("span");o.appendChild(document.createTextNode("*")),o.style.color="#FF5252",o.style.fontSize="22px",o.style.lineHeight="14px",o.style.verticalAlign="bottom";var l=document.createElement("label"),m=document.createTextNode(n),c=document.createElement("input");return c.type="checkbox",c.name=t,c.checked=a,c.onclick=r,e[c.name]=c.checked,l.appendChild(c),l.appendChild(m),i&&l.appendChild(o),l.appendChild(document.createElement("br")),l}function s(e){g(e)}function u(e){var t=60*(e+Be*Math.random())*1e3;He=setTimeout(function(){p()},t)}function p(){var n=t().GetEnemy(t().m_rgPlayerData.current_lane,t().m_rgPlayerData.target).m_data;if("undefined"!=typeof n){var a=n.type;a!=je.BOSS?(de("Refreshing, not boss",5),e.location.reload(!0)):(de("Not refreshing, A boss!",5),setTimeout(p,3e3))}else setTimeout(p,1e3)}function g(t){var n=t.target;return C(n.name,n.checked),e[n.name]=n.checked,n.checked}function _(e){var t=Re;void 0!==e&&(t=g(e)),We=t?Se:0}function y(e){var t=Ne;void 0!==e&&(t=g(e)),t?u(we):clearTimeout(He)}function h(t){var n=Ie;void 0!==t&&(n=Ie=g(t));var a=e.PIXI.ticker.shared;n?(a.autoStart=!1,a.stop(),e.g_Minigame.Render=function(){}):(a.autoStart=!0,a.start(),e.g_Minigame.Render=Ye,e.g_Minigame.Render())}function E(e){var t=Ge;void 0!==e&&(t=g(e)),t?R():D()}function f(e){var n=Me;void 0!==e&&(n=g(e)),n?t().DoCritEffect=function(e,t,n,a){}:t().DoCritEffect=Je}function v(e){var n=Oe;void 0!==e&&(n=g(e)),n?t().m_rgClickNumbers.push=function(e){e.container.removeChild(e)}:t().m_rgClickNumbers.push=Xe}function T(e){void 0!==e&&(De=e.target.value)}function C(e,t){try{"undefined"!==localStorage&&localStorage.setItem("steamdb-minigame/"+e,t)}catch(n){console.log(n)}}function b(e,t){try{if("undefined"!==localStorage){var n=localStorage.getItem("steamdb-minigame/"+e);return null!==n?n:t}}catch(a){return console.log(a),t}}function S(e,t){return"true"==b(e,t.toString())}function D(){for(var e=document.querySelector('a.link.element_upgrade_btn[data-type="3"]'),t=document.querySelector('a.link.element_upgrade_btn[data-type="4"]'),n=document.querySelector('a.link.element_upgrade_btn[data-type="5"]'),a=document.querySelector('a.link.element_upgrade_btn[data-type="6"]'),r=[e,t,n,a],i=0;i<r.length;i++)r[i].style.visibility="visible"}function R(){for(var n=[t().m_rgPlayerTechTree.damage_multiplier_fire,t().m_rgPlayerTechTree.damage_multiplier_water,t().m_rgPlayerTechTree.damage_multiplier_air,t().m_rgPlayerTechTree.damage_multiplier_earth],a=(parseInt(e.g_steamID.slice(-2))+parseInt(e.g_Minigame.gameid)%100)%4,r=0,i=-1,o=0;o<n.length;o++)de("Element "+o+" is at level "+(n[o]-1)/1.5,3),(n[o]-1)/1.5>=3&&(r++,i=o);return r>=2?void de("More than 2 elementals leveled to 3 or above, not locking.",1):void(1==r?(de("Found existing lock on "+i+", locking to it.",1),L(i)):(de("Locking to element "+a+" as chosen by SteamID",1),L(a)))}function L(e){for(var t=document.querySelector('a.link.element_upgrade_btn[data-type="3"]'),n=document.querySelector('a.link.element_upgrade_btn[data-type="4"]'),a=document.querySelector('a.link.element_upgrade_btn[data-type="5"]'),r=document.querySelector('a.link.element_upgrade_btn[data-type="6"]'),i=[t,n,a,r],o=0;o<i.length;o++)o!==e&&(i[o].style.visibility="hidden");qe=e}function A(n,a,r,i){var o=new e.PIXI.Text(r,{font:"35px 'Press Start 2P'",fill:i,stroke:"#000",strokeThickness:2});o.x=n,o.y=a,t().m_containerUI.addChild(o),o.container=t().m_containerUI;var l=new e.CEasingSinOut(o.y,-200,1e3);l.parent=o,o.m_easeY=l,l=new e.CEasingSinOut(2,-2,1e3),l.parent=o,o.m_easeAlpha=l,t().m_rgClickNumbers.push(o)}function x(){var e=t().m_rgLaneData[0].players+t().m_rgLaneData[1].players+t().m_rgLaneData[2].players;document.getElementById("players_in_game").innerHTML=e+"/1500"}function M(){for(var e,n=.4,a=.1,r=!1,i=0,l=0,m=0,c=0,d=-1,s=-1,u=[je.TREASURE,je.BOSS,je.MINIBOSS,je.SPAWNER,je.CREEP],p=!1,g=0,_=0,y=!1,h=!1,E=0;!r&&E<u.length;E++){y=u[E]==je.TREASURE,h=u[E]==je.BOSS;var f=[];for(e=0;3>e;e++)for(var v=0;4>v;v++){var T=t().GetEnemy(e,v);T&&T.m_data.type==u[E]&&(f[f.length]=T)}if(!y&&!h)for(var C=0,b=oe(),S=0;S<b.length;S++)if(e=b[S],0!==t().m_rgGameData.lanes[e].dps){var D=0;"undefined"!=typeof t().m_rgLaneData[e].abilities[17]&&(D=t().m_rgLaneData[e].abilities[17],de("stacks: "+D,3));for(var R=0;R<t().m_rgEnemies.length;R++){var L=t().m_rgEnemies[R].m_data.gold;D*L>C&&(C=D*L,s=t().m_rgEnemies[R].m_nID,d=e)}}var A=0;for(e=0;e<f.length;e++)if(f[e]&&!f[e].m_bIsDestroyed){if(1>i||f[e].m_flDisplayedHP<i){var x=t().m_rgGameData.lanes[f[e].m_nLane].element,M=t().CalculateDamage(t().m_rgPlayerTechTree.dps,x);if(!(M>=A))continue;A=M,r=!0,i=f[e].m_flDisplayedHP,l=f[e].m_nLane,m=f[e].m_nID}var P=f[e].m_flDisplayedHP/f[e].m_data.max_hp;(0===c||c>P)&&(c=P)}-1!=d&&-1!=s&&(l=d,m=s,de("Switching to a lane with best raining gold benefit",2)),u[E]==je.SPAWNER&&c>n&&-1==d&&(g=l,_=m,p=!0,r=!1),p&&u[E]==je.CREEP&&c>a&&(l=g,m=_)}if(r){t().m_nExpectedLane!=l&&(de("Switching to lane"+l,3),t().TryChangeLane(l)),t().m_nTarget!=m&&(de("Switching targets",3),t().TryChangeTarget(m));var O=Ce();y||h&&(O<$e.speedThreshold||O%$e.rainingRounds===0)?Qe.forEach(X):Qe.forEach(Y),O<$e.allowWormholeLevel&&!o()?X(Ve.WORMHOLE):Y(Ve.WORMHOLE)}}function P(){return me(Ve.DECREASE_COOLDOWNS)>0||Math.random()>$e.useAbilityChance?void X(Ve.DECREASE_COOLDOWNS):(z(Ve.DECREASE_COOLDOWNS)||Y(Ve.DECREASE_COOLDOWNS),void j(Ve.DECREASE_COOLDOWNS))}function O(e){return re(Ve.PUMPED_UP)?void de("Pumped up is always good.",2):(j(Ve.MEDICS)&&de("Medics is purchased, cooled down. Trigger it.",2),void(e>$e.reflectDamageThreshold&&re(Ve.REFLECT_DAMAGE)?de("We have reflect damage, cooled down. Trigger it.",2):e>$e.stealHealthThreshold&&re(Ve.STEAL_HEALTH)?de("We have steal health, cooled down. Trigger it.",2):re(Ve.GOD_MODE)&&de("We have god mode, cooled down. Trigger it.",2)))}function N(){re(Ve.CRIT)&&de("Crit chance is always good.",3),j(Ve.GOOD_LUCK_CHARMS)&&de("Good Luck Charms is purchased, cooled down, and needed. Trigger it.",2)}function k(){if(Q(Ve.CLUSTER_BOMB)&&!(Math.random()>$e.useAbilityChance)){for(var e=t().m_nExpectedLane,n=0,a=!1,r=Ce(),i=0;4>i;i++){var o=t().GetEnemy(e,i);o&&(n++,(0===o.m_data.type||r>$e.speedThreshold&&r%$e.rainingRounds!==0&&r%10===0)&&(a=!0))}a&&n>=3&&Z(Ve.CLUSTER_BOMB)}}function I(){if(Q(Ve.NAPALM)&&!(Math.random()>$e.useAbilityChance)){for(var e=t().m_nExpectedLane,n=0,a=!1,r=Ce(),i=0;4>i;i++){var o=t().GetEnemy(e,i);o&&(n++,(0===o.m_data.type||r>$e.speedThreshold&&r%$e.rainingRounds!==0&&r%10===0)&&(a=!0))}a&&n>=3&&Z(Ve.NAPALM)}}function G(){if(Q(Ve.MORALE_BOOSTER)&&!(Math.random()>$e.useAbilityChance)){for(var e=0,n=0;n<t().m_rgGameData.lanes[t().m_nExpectedLane].enemies.length;n++)t().m_rgGameData.lanes[t().m_nExpectedLane].enemies[n].hp>1e6&&e++;e>=2&&(de("Moral Booster is purchased, cooled down, and needed. Trigger it.",2),Z(Ve.MORALE_BOOSTER))}}function w(){if(Q(Ve.TACTICAL_NUKE)&&!(Math.random()>$e.useAbilityChance)){for(var e=t().m_nExpectedLane,n=!1,a=0,r=Ce(),i=0;4>i;i++){var o=t().GetEnemy(e,i);o&&(0===o.m_data.type||r>$e.speedThreshold&&r%$e.rainingRounds!==0&&r%10===0)&&(n=!0,a=o.m_flDisplayedHP/o.m_data.max_hp)}n&&.6>a&&a>.3&&(de("Tactical Nuke is purchased, cooled down, and needed. Nuke 'em.",2),Z(Ve.TACTICAL_NUKE))}}function B(){if(ne(Ve.CRIPPLE_MONSTER)&&!(Math.random()>$e.useAbilityChance)){var e=Ce();if(e>$e.speedThreshold&&e%$e.rainingRounds!==0&&e%10===0){var n=t().GetEnemy(t().m_rgPlayerData.current_lane,t().m_rgPlayerData.target);if(n&&n.m_data.type==je.BOSS){var a=n.m_flDisplayedHP/n.m_data.max_hp;a>.5&&(de("Cripple Monster available and used on boss",2),ie(Ve.CRIPPLE_MONSTER))}}}}function F(){if(ne(Ve.CRIPPLE_SPAWNER)&&!(Math.random()>$e.useAbilityChance)){for(var e=t().m_nExpectedLane,n=!1,a=0,r=0;4>r;r++){var i=t().GetEnemy(e,r);i&&0===i.m_data.type&&(n=!0,a=i.m_flDisplayedHP/i.m_data.max_hp)}n&&a>.95&&(de("Cripple Spawner available, and needed. Cripple 'em.",2),ie(Ve.CRIPPLE_SPAWNER))}}function U(){if(ne(Ve.RAINING_GOLD)){var e=t().GetEnemy(t().m_rgPlayerData.current_lane,t().m_rgPlayerData.target);if(e&&e.m_data.type==je.BOSS){var n=e.m_flDisplayedHP/e.m_data.max_hp;n>=.6&&(de("Gold rain is purchased and cooled down, Triggering it on boss",2),ie(Ve.RAINING_GOLD))}}}function H(){if(Ce()<=30&&ne(Ve.TREASURE)&&ie(Ve.TREASURE),Q(Ve.METAL_DETECTOR)||ne(Ve.TREASURE)){if(z(Ve.METAL_DETECTOR))return;var e=t().GetEnemy(t().m_rgPlayerData.current_lane,t().m_rgPlayerData.target);if(e&&e.m_data.type==je.BOSS){var n=e.m_flDisplayedHP/e.m_data.max_hp;.25>=n&&(Q(Ve.METAL_DETECTOR)?(de("Metal Detector is purchased and cooled down, Triggering it on boss",2),Z(Ve.METAL_DETECTOR)):ne(Ve.TREASURE)&&(de("Treasure is available and cooled down, Triggering it on boss",2),ie(Ve.TREASURE)))}}}function W(){z(Ve.MAX_ELEMENTAL_DAMAGE)||Math.random()>$e.useAbilityChance||re(Ve.MAX_ELEMENTAL_DAMAGE,!0)&&de("Max Elemental Damage is purchased and cooled down, triggering it.",2)}function q(){var e=Ce();e<$e.speedThreshold||e%$e.rainingRounds!==0||(re(Ve.WORMHOLE)?de("Less than "+$e.minsLeft+" minutes for game to end. Triggering wormholes...",2):o()&&re(Ve.THROW_MONEY_AT_SCREEN)&&de("Less than "+$e.minsLeft+" minutes for game to end. Throwing money at screen for no particular reason...",2))}function K(e){e%10===9&&re(Ve.RESURRECTION)&&Math.random()<=$e.useAbilityChance&&de("Triggered Resurrect.")}function J(){t().m_bIsDead&&t().m_rgPlayerData.time_died+5<t().m_nTime&&e.RespawnPlayer()}function X(e){$(e,!1)}function Y(e){$(e,!0)}function $(e,t){var n=t===!0?"visible":"hidden",a=document.getElementById("ability_"+e);a||(a=document.getElementById("abilityitem_"+e)),a&&a.childElements()&&a.childElements().length>=1&&(a.childElements()[0].style.visibility=n)}function z(e){return t().bIsAbilityActive(e)}function V(e){var t=document.getElementById("ability_"+e);return t&&t.childElements()&&t.childElements().length>=1?"hidden"!==t.childElements()[0].style.visibility:!1}function Q(e){return te(e)&&!ee(e)&&V(e)}function j(e){return Q(e)?(Z(e),!0):!1}function Z(e){t().m_rgAbilityQueue.push({ability:e})}function ee(e){return t().GetCooldownForAbility(e)>0}function te(e){return 1<<e&t().m_rgPlayerTechTree.unlocked_abilities_bitfield}function ne(e){return ae(e)&&!ee(e)&&ce(e)}function ae(e){for(var n=0;n<t().m_rgPlayerTechTree.ability_items.length;++n){var a=t().m_rgPlayerTechTree.ability_items[n];if(a.ability==e)return!0}return!1}function re(e,t){return ne(e)?t&&me(e)>0?!1:(ie(e),!0):!1}function ie(e){var n=document.getElementById("abilityitem_"+e);n&&n.childElements()&&n.childElements().length>=1&&t().TryAbility(document.getElementById("abilityitem_"+e).childElements()[0])}function oe(){for(var e=[t().m_rgPlayerTechTree.damage_multiplier_fire,t().m_rgPlayerTechTree.damage_multiplier_water,t().m_rgPlayerTechTree.damage_multiplier_air,t().m_rgPlayerTechTree.damage_multiplier_earth],n=t().m_rgGameData.lanes,a=[],r=0;r<n.length;r++)a[r]=r;return a.sort(function(t,a){return e[n[a].element-1]-e[n[t].element-1]}),de("Lane IDs  : "+a[0]+" "+a[1]+" "+a[2],4),de("Elements  : "+n[a[0]].element+" "+n[a[1]].element+" "+n[a[2]].element,4),a}function le(){return t().m_rgGameData.timestamp}function me(e){for(var n=(le(),t().m_rgGameData.lanes[t().m_rgPlayerData.current_lane].active_player_abilities),a=0,r=0;r<n.length;r++)n[r].ability!=e||n[r].timestamp_done<Date.now()||a++;return a}function ce(e){var t=document.getElementById("abilityitem_"+e);return t&&t.childElements()&&t.childElements().length>=1?"hidden"!==t.childElements()[0].style.visibility:!1}function de(e,t){De>=t&&console.log(e)}function se(e){for(var t=0,n=0,a=0;24>a;a++)e>=3600&&(e-=3600,t+=1);for(var r=0;60>r;r++)e>=60&&(e-=60,n+=1);return{hours:t,minutes:n}}function ue(e){var n=Math.floor(t().m_nTime)%86400;n-=57600,0>n&&(n+=86400);var a=86400-n,r=le()-t().m_rgGameData.timestamp_game_start,i=Math.floor(e/r*a+e),o=Math.floor((i-e)/Math.log(3))+e;return{expected_level:i,likely_level:o,remaining_time:a}}function pe(e){var t=ue(e),n=se(t.remaining_time);document.ExpectedLevel.textContent="Level: "+e+", Expected Level: "+t.expected_level+", Likely Level: "+t.likely_level,document.RemainingTime.textContent="Remaining Time: "+n.hours+" hours, "+n.minutes+" minutes."}function ge(){return 100*t().m_rgPlayerTechTree.crit_percentage}function _e(){return t().m_rgPlayerTechTree.damage_multiplier_crit}function ye(){return t().m_rgPlayerTechTree.dps}function he(){return t().m_rgPlayerTechTree.damage_per_click}function Ee(){return t().m_rgPlayerTechTree.damage_per_click_multiplier}function fe(){return 100*t().m_rgPlayerTechTree.boss_loot_drop_percentage}function ve(){e.CSceneGame.prototype.ClearNewPlayer=function(){},t().m_spriteFinger||(e.WebStorage.SetLocal("mg_how2click",0),t().CheckNewPlayer(),e.WebStorage.SetLocal("mg_how2click",1)),document.getElementById("newplayer").style.display="none"}function Te(){var t=e.fnTooltipUpgradeDesc;e.fnTooltipUpgradeDesc=function(n){var a=e.$J(n),r=a.data("desc"),i=r,o=parseFloat(a.data("multiplier"));switch(a.data("upgrade_type")){case 2:i=t(n);var l=he()*_e(),m=e.g_Minigame.CurrentScene().m_rgTuningData.player.damage_per_click*(Ee()+o)*_e();i+="<br><br>Crit Click: "+e.FormatNumberForDisplay(l)+" => "+e.FormatNumberForDisplay(m);break;case 7:var c=_e(),d=c+o,s=ye(),u=he();i+="<br><br>You can have multiple crits in a second. The server combines them into one.",i+="<br><br>Crit Percentage: "+ge().toFixed(1)+"%",i+="<br><br>Critical Damage Multiplier:",i+="<br>Current: "+c+"x",i+="<br>Next Level: "+d+"x",i+="<br><br>Damage with one crit:",i+="<br>DPS: "+e.FormatNumberForDisplay(c*s)+" => "+e.FormatNumberForDisplay(d*s),i+="<br>Click: "+e.FormatNumberForDisplay(c*u)+" => "+e.FormatNumberForDisplay(d*u),i+="<br><br>Base Increased By: "+e.FormatNumberForDisplay(o)+"x";break;case 9:i+="<br><br>Boss Loot Drop Rate:",i+="<br>Current: "+fe().toFixed(0)+"%",i+="<br>Next Level: "+(fe()+100*o).toFixed(0)+"%",i+="<br><br>Base Increased By: "+e.FormatNumberForDisplay(100*o)+"%";break;default:return t(n)}return i};var n=e.fnTooltipUpgradeElementDesc;e.fnTooltipUpgradeElementDesc=function(t){var a=n(t),r=e.$J(t),i=(e.g_Minigame.CurrentScene().m_rgTuningData.upgrades.slice(0),r.data("type")),o=qe==i-3;return o?(a+="<br><br>This is your recommended element. Please upgrade this.",e.enableElementLock&&(a+="<br><br>Other elements are LOCKED to prevent accidentally upgrading.")):-1!=qe&&(a+="<br><br>This is NOT your recommended element. DO NOT upgrade this."),a}}function Ce(){return t().m_rgGameData.level+1}var be="4.2.4",Se=20,De=1,Re=S("enableAutoClicker",!0),Le=S("removeInterface",!0),Ae=S("removeParticles",!0),xe=S("removeFlinching",!0),Me=S("removeCritText",!1),Pe=S("removeGoldText",!1),Oe=S("removeAllText",!1),Ne=S("enableAutoRefresh","undefined"!=typeof GM_info),ke=S("enableFingering",!0),Ie=S("disableRenderer",!1),Ge=S("enableElementLock",!0),we=30,Be=10,Fe=30,Ue=!1,He=null,We=Se,qe=-1,Ke=0,Je=function(){},Xe=function(){},Ye=function(){},$e={speedThreshold:5e3,rainingRounds:500,timePerUpdate:6e4,useSlowMode:!1,minsLeft:60,allowWormholeLevel:18e4,githubVersion:be,useAbilityChance:.1,useGoldThreshold:200},ze=(S("showedUpdateInfo",!1),{}),Ve={FIRE_WEAPON:1,CHANGE_LANE:2,RESPAWN:3,CHANGE_TARGET:4,MORALE_BOOSTER:5,GOOD_LUCK_CHARMS:6,MEDICS:7,METAL_DETECTOR:8,DECREASE_COOLDOWNS:9,TACTICAL_NUKE:10,CLUSTER_BOMB:11,NAPALM:12,RESURRECTION:13,CRIPPLE_SPAWNER:14,CRIPPLE_MONSTER:15,MAX_ELEMENTAL_DAMAGE:16,RAINING_GOLD:17,CRIT:18,PUMPED_UP:19,THROW_MONEY_AT_SCREEN:20,GOD_MODE:21,TREASURE:22,STEAL_HEALTH:23,REFLECT_DAMAGE:24,FEELING_LUCKY:25,WORMHOLE:26,LIKE_NEW:27},Qe=["MORALE_BOOSTER","GOOD_LUCK_CHARMS","TACTICAL_NUKE","CLUSTER_BOMB","NAPALM","CRIT","CRIPPLE_SPAWNER","CRIPPLE_MONSTER","MAX_ELEMENTAL_DAMAGE","REFLECT_DAMAGE","THROW_MONEY_AT_SCREEN"],je={SPAWNER:0,CREEP:1,BOSS:2,MINIBOSS:3,TREASURE:4};i(),e.SteamDB_Minigame_Timer&&e.clearInterval(e.SteamDB_Minigame_Timer),e.SteamDB_Minigame_Timer=e.setInterval(function(){e.g_Minigame&&t().m_bRunning&&t().m_rgPlayerTechTree&&t().m_rgGameData&&(e.clearInterval(e.SteamDB_Minigame_Timer),n(),e.SteamDB_Minigame_Timer=e.setInterval(l,1e3))},1e3),e.setTimeout(function(){e.g_Minigame&&e.g_Minigame.m_CurrentScene&&e.g_Minigame.m_CurrentScene.m_rgGameData||e.location.reload(!0)},1e3*Fe);var Ze=document.querySelector(".breadcrumbs");if(Ze){var et=document.createElement("span");et.textContent=" > ",Ze.appendChild(et),et=document.createElement("span"),et.style.color="#D4E157",et.style.textShadow="1px 1px 0px rgba( 0, 0, 0, 0.3 )",et.textContent="Room "+e.g_GameID,Ze.appendChild(et),et=document.createElement("span"),et.textContent=" > ",Ze.appendChild(et),et=document.createElement("span"),et.style.color="#FFA07A",et.style.textShadow="1px 1px 0px rgba( 0, 0, 0, 0.3 )",et.textContent="Level: 0, Expected Level: 0, Likely Level: 0",Ze.appendChild(et),document.ExpectedLevel=et,et=document.createElement("span"),et.textContent=" > ",Ze.appendChild(et),et=document.createElement("span"),et.style.color="#9AC0FF",et.style.textShadow="1px 1px 0px rgba( 0, 0, 0, 0.3 )",et.textContent="Remaining Time: 0 hours, 0 minutes.",Ze.appendChild(et),document.RemainingTime=et}}(window);